<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LitWire Social Network</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <script>
        window.__firebase_config = JSON.stringify({
            apiKey: "AIzaSyBxYO1_dzEP2eLAADSG1hsjKBcDjeFCpmk",
            authDomain: "litwire-97956.firebaseapp.com",
            projectId: "litwire-97956",
            storageBucket: "litwire-97956.firebasestorage.app",
            messagingSenderId: "263009111921",
            appId: "1:263009111921:web:713622b1cfa59ddb9130d0",
            measurementId: "G-ZWVFHF5YQX"
        });

        window.__app_id = "litwire-app";
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .hidden {
            display: none;
        }
        .spinner-border {
            border-top-color: #f3f4f6;
        }
        .btn-author {
            background-color: #2e598b;
            color: #fff;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn-author:hover {
            background-color: #234368;
        }
        .btn-influencer {
            background-color: #e5e7eb;
            color: #1f2937;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn-influencer:hover {
            background-color: #d1d5db;
        }
        .btn-get-started {
            background-color: #2e598b;
            color: #fff;
            padding: 1.25rem 2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn-get-started:hover {
            background-color: #234368;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <header class="bg-white shadow-md py-4 sticky top-0 z-50">
        <nav class="container flex justify-between items-center px-4 md:px-8">
            <div class="text-3xl font-bold text-gray-800">
                <span class="text-blue-900">Lit</span><span class="text-gray-900">Wire</span>
            </div>
            <div class="flex items-center space-x-6">
                <button id="nav-login" class="text-gray-600 hover:text-blue-900 font-medium transition duration-300">Login</button>
                <button id="nav-signup" class="bg-gray-800 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-900 transition duration-300">Sign Up</button>
            </div>
        </nav>
    </header>

    <main class="flex-grow container mt-12 px-4 md:px-8">
        <div id="loading" class="text-center py-10">
            <div class="spinner-border animate-spin inline-block w-12 h-12 border-4 rounded-full border-blue-900 border-r-transparent" role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <p class="text-gray-600 mt-4" id="loading-message">Connecting to the LitWire network...</p>
        </div>

        <div id="config-missing" class="bg-red-50 border border-red-200 rounded-lg p-6 text-center hidden">
            <h2 class="text-2xl font-bold text-red-800 mb-4">Firebase Configuration Missing</h2>
            <p class="text-red-600 mb-4">To use LitWire, you need to add your Firebase project configuration.</p>
            <div class="bg-white p-4 rounded border text-left text-sm">
                <p class="font-semibold mb-2">Add this script tag before the closing &lt;/head&gt; tag:</p>
                <pre class="bg-gray-100 p-3 rounded text-xs overflow-x-auto"><code>&lt;script&gt;
// Replace with your Firebase project config
window.__firebase_config = JSON.stringify({
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
});
window.__app_id = "litwire-app";
&lt;/script&gt;</code></pre>
            </div>
            <button id="demo-mode-btn" class="mt-4 px-6 py-3 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition duration-300">
                Continue in Demo Mode (No Save)
            </button>
        </div>

        <!-- The main landing page view -->
        <section id="onboarding-view" class="view">
            <div class="text-center py-20">
                <h1 class="text-5xl font-bold text-gray-900 leading-tight">Where stories meet<br>their champions</h1>
                <p class="mt-4 max-w-2xl mx-auto text-gray-600 text-lg">
                    A curated matchmaking platform connecting authors with book influencers who actually fit their genre, style, and audience.
                </p>
                <div class="flex justify-center space-x-4 mt-8">
                    <a href="author.html" class="btn-author">I'm an Author</a>
                    <a href="influencer.html" class="btn-influencer">I'm an Influencer</a>
                </div>
            </div>

            <!-- Workflow section -->
            <div class="mt-20 py-12 px-8 bg-white rounded-2xl shadow-lg flex flex-col md:flex-row items-center justify-around text-center">
                <div class="flex flex-col items-center">
                    <i class="fas fa-list-check text-4xl text-blue-900"></i>
                    <p class="mt-2 text-lg text-gray-700 font-semibold">Survey</p>
                </div>
                <div class="text-2xl font-thin text-gray-400 my-4 md:my-0">‚Üí</div>
                <div class="flex flex-col items-center">
                    <i class="fas fa-user-friends text-4xl text-blue-900"></i>
                    <p class="mt-2 text-lg text-gray-700 font-semibold">Matches</p>
                </div>
                <div class="text-2xl font-thin text-gray-400 my-4 md:my-0">‚Üí</div>
                <div class="flex flex-col items-center">
                    <i class="fas fa-chart-line text-4xl text-blue-900"></i>
                    <p class="mt-2 text-lg text-gray-700 font-semibold">Dashboard</p>
                </div>
            </div>

            <!-- Testimonials section -->
            <div class="mt-20 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-xl shadow-lg border-l-4 border-blue-900">
                    <p class="text-gray-700 font-medium text-lg italic">
                        "I've connected with amazing book lovers who really get my work."
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg border-l-4 border-blue-900">
                    <p class="text-gray-700 font-medium text-lg italic">
                        "A game-changer for finding new reads in my niche."
                    </p>
                </div>
            </div>

            <!-- Logos section (placeholders) -->
            <div class="mt-20 flex justify-center space-x-12 items-center">
                <!-- Replace these with actual SVGs or image tags -->
                <span class="text-gray-400 text-5xl">üå∑</span>
                <span class="text-gray-400 text-5xl">‚ö´</span>
                <span class="text-gray-400 text-5xl">‚ñ∂Ô∏è</span>
                <span class="text-gray-400 text-4xl">TDJ</span>
                <span class="text-gray-400 text-4xl">wisco</span>
            </div>

            <!-- Call to Action button -->
            <div class="mt-20 text-center">
                <a href="author.html" class="btn-get-started">Start your free campaign plan today ‚Üí</a>
            </div>
        </section>

        <div id="content" class="space-y-12 hidden">
            <!-- This section is now hidden on this page, as it will be loaded after a profile is created -->
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container text-center text-sm">
            &copy; 2024 LitWire. All rights reserved.
        </div>
    </footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // Configuration variables
    const appId = typeof window.__app_id !== 'undefined' ? window.__app_id : 'demo-app';
    let firebaseConfig = null;
    let demoMode = false;

    // Parse Firebase config
    try {
        if (typeof window.__firebase_config !== 'undefined' && window.__firebase_config) {
            firebaseConfig = JSON.parse(window.__firebase_config);
        }
    } catch (e) {
        console.error("Failed to parse Firebase configuration:", e);
    }

    let app, db, auth;

    // DOM elements
    const loadingEl = document.getElementById('loading');
    const configMissingEl = document.getElementById('config-missing');
    const onboardingView = document.getElementById('onboarding-view');
    const contentEl = document.getElementById('content');

    // Initialize Firebase or fall back to demo mode
    async function initApp() {
        if (!firebaseConfig) {
            loadingEl.classList.add('hidden');
            configMissingEl.classList.remove('hidden');
            document.getElementById('demo-mode-btn').addEventListener('click', startDemoMode);
            return;
        }

        try {
            // Initialize Firebase
            app = initializeApp(firebaseConfig, appId);
            auth = getAuth(app);
            db = getFirestore(app);
            
            // Check auth state
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    // User is signed in
                    try {
                        // Check if user has a profile
                        const userDoc = await getDoc(doc(db, "users", user.uid));
                        if (userDoc.exists()) {
                            // User has a profile, redirect to the main app page
                            window.location.href = 'main.html';
                        } else {
                            // No profile yet, show onboarding
                            showOnboarding();
                        }
                    } catch (error) {
                        console.error("Error checking user profile:", error);
                        showOnboarding();
                    }
                } else {
                    // User is not signed in, sign in anonymously
                    try {
                        await signInAnonymously(auth);
                    } catch (error) {
                        console.error("Error signing in anonymously:", error);
                        startDemoMode();
                    }
                }
            });
        } catch (error) {
            console.error("Error initializing Firebase:", error);
            startDemoMode();
        }
    }

    function startDemoMode() {
        demoMode = true;
        // In demo mode, show onboarding and don't try to auto-redirect
        loadingEl.classList.add('hidden');
        onboardingView.classList.remove('hidden');
    }

    function showOnboarding() {
        loadingEl.classList.add('hidden');
        onboardingView.classList.remove('hidden');
    }

    // Initialize the app
    initApp();
</script>
</body>
</html>
